<div class="market-insights-page">
    <!-- Hero Section -->
    <section class="hero-section">
        <div class="hero-overlay"></div>
        <div class="container hero-container">
            <div class="hero-content">
                <h1>Market Insights</h1>
                <p class="subtitle">Discover rental price trends powered by AI predictions</p>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <div class="main-content">
        <div class="container">
            <!-- Controls Bar -->
            <div class="controls-bar">
                <div class="controls-left">
                    <h2>Price Heatmap</h2>
                    <p>Explore market trends across neighborhoods</p>
                </div>
                <div class="rental-type-toggle">
                    <button [class.active]="selectedType === TypeOfRental.MONTHLY"
                        (click)="onTypeChange(TypeOfRental.MONTHLY)" class="toggle-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                            <line x1="16" y1="2" x2="16" y2="6"></line>
                            <line x1="8" y1="2" x2="8" y2="6"></line>
                            <line x1="3" y1="10" x2="21" y2="10"></line>
                        </svg>
                        Monthly
                    </button>
                    <button [class.active]="selectedType === TypeOfRental.DAILY"
                        (click)="onTypeChange(TypeOfRental.DAILY)" class="toggle-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10"></circle>
                            <polyline points="12 6 12 12 16 14"></polyline>
                        </svg>
                        Daily
                    </button>
                </div>
            </div>

            <!-- Map Card -->
            <div class="map-card">
                <!-- Loading State -->
                <div *ngIf="isLoading" class="loading-state">
                    <div class="spinner"></div>
                    <p>Loading market insights...</p>
                </div>

                <!-- Error State -->
                <div *ngIf="errorMessage && !isLoading" class="error-state">
                    <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="12" y1="8" x2="12" y2="12"></line>
                        <line x1="12" y1="16" x2="12.01" y2="16"></line>
                    </svg>
                    <h3>Unable to Load Data</h3>
                    <p>{{ errorMessage }}</p>
                    <button class="btn-retry" (click)="loadHeatmapData()">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polyline points="23 4 23 10 17 10"></polyline>
                            <polyline points="1 20 1 14 7 14"></polyline>
                            <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
                        </svg>
                        Try Again
                    </button>
                </div>

                <!-- Map Container -->
                <div id="heatmap-container" [class.hidden]="isLoading || errorMessage" class="map-container">
                </div>

                <!-- Legend -->
                <div *ngIf="!isLoading && !errorMessage" class="legend">
                    <h3>Market Status</h3>
                    <div class="legend-items">
                        <div class="legend-item">
                            <span class="legend-dot hot">
                                <svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <path d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
                                </svg>
                            </span>
                            <span class="legend-label">High Demand</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-dot stable">
                                <svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <path d="M5 12h14"></path>
                                </svg>
                            </span>
                            <span class="legend-label">Balanced</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-dot cool">
                                <svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <path d="M13 17h8m0 0V9m0 8l-8-8-4 4-6-6"></path>
                                </svg>
                            </span>
                            <span class="legend-label">Low Demand</span>
                        </div>
                    </div>
                    <p class="legend-note">Interactive data points</p>
                </div>
            </div>

            <!-- Info Cards -->
            <div class="info-cards">
                <div class="info-card">
                    <div class="icon-wrapper hot">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
                        </svg>
                    </div>
                    <h3>High Demand</h3>
                    <p>Markets experiencing rising interest. Ideal for growth-focused analysis.</p>
                </div>
                <div class="info-card">
                    <div class="icon-wrapper stable">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M5 12h14"></path>
                        </svg>
                    </div>
                    <h3>Balanced</h3>
                    <p>Consistent pricing and steady supply. Predictable market conditions.</p>
                </div>
                <div class="info-card">
                    <div class="icon-wrapper cool">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M13 17h8m0 0V9m0 8l-8-8-4 4-6-6"></path>
                        </svg>
                    </div>
                    <h3>Low Demand</h3>
                    <p>Increased availability with softening prices. Favorable for new entries.</p>
                </div>
            </div>
        </div>
    </div>
</div>